<div class="container">
  <div class="canvas-container">
    <!-- Three.js se renderizará aquí -->
  </div>

  <div class="overlay">
    <div class="header">
      <h1>Starlink Handover Visualizer</h1>
      <p>Satélites activos: {{ tle.getAllSatrecs().length }}</p>
    </div>

    <div *ngIf="loadingFirstFrame" class="loading-overlay">
      <div class="loading-content">
        <p>Cargando satélites... {{loadingProgress}}%</p>
        <p>Satélites propagados: {{firstFrameReceived}} / {{firstFrameSatCount}}</p>
        <p *ngIf="loadingElapsedMs > 0">Tiempo de carga: {{loadingElapsedMs | number:'1.0-0'}} ms</p>
        <progress [value]="loadingProgress" max="100"></progress>
      </div>
    </div>

    <div class="metrics-panel" *ngIf="currentMetrics">
      <h2>Métricas del satélite actual</h2>
      <div class="metric">
        <label>Elevación:</label>
        <span>{{ currentMetrics.elevation | number:'1.1-1' }}°</span>
      </div>
      <div class="metric">
        <label>RSSI:</label>
        <span>{{ currentMetrics.rssi | number:'1.1-1' }} dBm</span>
      </div>
      <div class="metric">
        <label>SNR:</label>
        <span>{{ currentMetrics.snr | number:'1.1-1' }} dB</span>
      </div>
      <div class="metric">
        <label>Throughput:</label>
        <span>{{ currentMetrics.throughput | number:'1.1-1' }} Mbps</span>
      </div>
      <div class="metric">
        <label>Latencia:</label>
        <span>{{ currentMetrics.latency | number:'1.1-1' }} ms</span>
      </div>
    </div>

    <div class="controls-panel">
      <h2>Controles</h2>
      <div class="control-group">
        <label>Posición del Usuario</label>
        <div class="coordinates">
          <input type="number" [(ngModel)]="userLat" (change)="updateUserPosition()" placeholder="Latitud" min="-90"
            max="90">
          <input type="number" [(ngModel)]="userLon" (change)="updateUserPosition()" placeholder="Longitud" min="-180"
            max="180">
        </div>
      </div>

      <div class="control-group">
        <label>Parámetros de Handover</label>
        <div class="slider">
          <label>Histéresis (°)</label>
          <input type="range" [(ngModel)]="hysteresis" min="0" max="10" step="0.5">
          <span>{{ hysteresis }}°</span>
        </div>
        <div class="slider">
          <label>Cooldown (s)</label>
          <input type="range" [(ngModel)]="cooldown" min="0" max="60" step="5">
          <span>{{ cooldown }}s</span>
        </div>
      </div>

      <div class="control-group">
        <label>Velocidad del tiempo</label>
        <div class="slider">
          <label>Multiplicador de tiempo (x)</label>
          <input type="range" [(ngModel)]="timeMultiplier" min="0.1" max="50" step="0.1">
          <span>{{ timeMultiplier | number:'1.1-1' }}x</span>
        </div>
        <button (click)="resetSimTime()">Resetear tiempo simulado</button>
      </div>
    </div>
  </div>
</div>